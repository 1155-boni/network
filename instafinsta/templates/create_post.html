{% extends "base.html" %}

{% block content %}
<div class="auth-container">
  <div class="instagram-card">
    <h3 class="auth-heading">Create a New Post</h3>
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <!-- Caption -->
      <div class="mb-3">
        <label class="form-label">Caption</label>
        <textarea name="caption" class="form-input" rows="3" placeholder="Write a caption..."></textarea>
      </div>

      <!-- Image -->
      <div class="mb-3">
        <label class="form-label">Upload Image</label>
        <input type="file" name="image" id="image-input" class="form-input" accept="image/*">
        <img id="image-preview" class="post-preview-image mt-2" style="display: none; max-width: 100%; border-radius: 8px;">
      </div>

      <button type="submit" class="primary-btn w-100">Post</button>
      <a href="{% url 'feed' %}" class="outline-btn w-100 mt-2">Cancel</a>
    </form>

    <script>
      document.getElementById('image-input').addEventListener('change', function(e) {
        const file = e.target.files[0];
        const preview = document.getElementById('image-preview');
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = 'block';
          };
          reader.readAsDataURL(file);
        } else {
          preview.style.display = 'none';
        }
      });
    </script>
  </div>
</div>
{% endblock %}
