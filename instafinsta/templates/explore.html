{% extends "base.html" %}
{% load static %}
{% block title %}Explore{% endblock %}

{% block content %}
<div class="container">
  <h2 class="mb-4">Explore</h2>

  <!-- Search Form -->
  <form method="get" action="{% url 'explore' %}" class="mb-4">
    <div class="input-group">
      <input type="text" class="form-input" name="q" placeholder="Search users..." value="{{ query }}">
      <button class="primary-btn" type="submit">Search</button>
    </div>
  </form>

  {% if query %}
    <!-- Show users if searching -->
    <h4>Users</h4>
    {% if users %}
      <div class="explore-users-list">
        {% for u in users %}
          <div class="explore-user-item">
            {% if u.profile.avatar %}
              <img src="{{ u.profile.avatar.url }}" class="user-avatar-small" alt="{{ u.username }}">
            {% else %}
              <img src="{% static 'images/default.jpg' %}" class="user-avatar-small" alt="Default">
            {% endif %}
            <a href="{% url 'view_profile' u.username %}" class="text-dark text-decoration-none fw-bold">
              {{ u.username }}
            </a>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>No users found.</p>
    {% endif %}
  {% else %}
    <!-- Show random posts if not searching -->
    <div class="explore-posts-grid">
      {% for post in posts %}
        <div class="explore-post-card">
          {% if post.image %}
            <img src="{{ post.image.url }}" class="explore-post-image" alt="Post">
            <div class="explore-post-overlay">
              <div class="overlay-content">
                <span><i class="bi bi-heart"></i> {{ post.like_count }}</span>
                <span><i class="bi bi-chat"></i> {{ post.comments.count }}</span>
              </div>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>
{% endblock %}
